'use strict';

import React, {Component} from 'react';
import {
  StyleSheet,
  ScrollView,
  StatusBar,
  View,
  Text,
  Image,
  Animated,
  Platform,
  TextInput,
  TouchableOpacity,
  FlatList,
  SectionList,
  Modal,
  ImageBackground,
} from 'react-native';
import Config from '../config/config';
import Api from '../config/api';
import MainStyle from '../styles/MainStyle';
import NoConnection from '../components/NoConnection';
import Preloader from '../components/Preloader';
import HTML from 'react-native-render-html';
import AppButton from '../components/AppButton';

//const data = "<p><strong>\u041a\u0430\u0437\u0430\u0445\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a<\/strong> \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0441\u044f \u043a \u0442\u044e\u0440\u043a\u0441\u043a\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u0435 \u044f\u0437\u044b\u043a\u043e\u0432. \u0412 \u0441\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u043c \u043a\u0430\u0437\u0430\u0445\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 42 \u0431\u0443\u043a\u0432\u044b, \u0438\u0437 \u043d\u0438\u0445 9 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0432\u0443\u043a\u043e\u0432 \u043a\u0430\u0437\u0430\u0445\u0441\u043a\u043e\u0433\u043e \u044f\u0437\u044b\u043a\u0430.<\/p>\n<h3 style=\"text-align: center;\">\u041a\u0440\u0430\u0442\u043a\u0438\u0435 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043a\u0430\u0437\u0430\u0445\u0441\u043a\u043e\u0433\u043e \u044f\u0437\u044b\u043a\u0430<\/h3>\n<p>\u0412 \u043a\u0430\u0437\u0430\u0445\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u00ab\u044c\u00bb \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0433\u04af\u043b\u0434\u0435\u0440; \u043d\u0435\u0442 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0440\u043e\u0434\u0430 (\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0440\u043e\u0434\u0430 \u043f\u043e \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0443) \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: \u043e\u043b \u2013 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043e\u043d, \u043e\u043d\u0430 \u2013 \u043e\u043b \u043a\u0435\u043b\u0434\u0456 \u2013 \u043e\u043d (\u0430) \u043f\u0440\u0438\u0448\u0435\u043b (\u0430); \u043d\u0435\u0442 \u043f\u0440\u0435\u0434\u043b\u043e\u0433\u043e\u0432 (\u043f\u0440\u0438 \u043f\u043e\u043c\u043e\u0449\u0438 \u0430\u0444\u0444\u0438\u043a\u0441\u043e\u0432). \u0423\u0434\u0430\u0440\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0432\u0438\u0442\u0441\u044f \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c, \u0440\u0435\u0436\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u043c\u0435\u0441\u0442\u0435. \u0421\u043a\u0430\u0437\u0443\u0435\u043c\u043e\u0435 \u043f\u0438\u0448\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u043c\u0435\u0441\u0442\u0435. \u0412 \u043a\u0430\u0437\u0430\u0445\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 7 \u043f\u0430\u0434\u0435\u0436\u0435\u0439.<\/p>\n<p>&nbsp;<\/p>\n<h3 style=\"text-align: center;\">9 \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0432\u0443\u043a\u043e\u0432 5 \u0433\u043b\u0430\u0441\u043d\u044b\u0445, 4 \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u044b\u0445<\/h3>\n<p style=\"text-align: center;\"><strong>\u0433\u043b\u0430\u0441\u043d\u044b\u0435<\/strong> \u2013 \u04d9, \u0456, \u04af, \u04af, \u04e9 <strong>\u0441\u043e\u0433\u043b\u0430\u0441\u043d\u044b\u0435<\/strong> \u2013 \u04a3, \u049b, \u0493, \u04bb<\/p>\n<h3 style=\"text-align: center;\">\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430 \u0437\u0432\u0443\u043a\u043e\u0432<\/h3>\n<p><strong>\u04d8, \u04d9 \u2013 \u0433\u043b\u0430\u0441\u043d\u044b\u0439, \u043c\u044f\u0433\u043a\u0438\u0439, \u043d\u0435\u0433\u0443\u0431\u043d\u043e\u0439<\/strong>.<\/p>\n<p>\u0410\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0439 \u0437\u0432\u0443\u043a \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 \u043a\u0430\u043a <strong>\u00ab\u0435\u0456\u00bb \u2013 \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 (\u043al\u0435\u0456\u043f \u0438 \u0442.\u0434.);<\/strong> \u0432 \u0440\u0443\u0441\u0441\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 \u0441\u0440\u0435\u0434\u043d\u0438\u0439 \u043c\u0435\u0436\u0434\u0443 \u00ab<strong>\u0430<\/strong> \u0438 <strong>\u044f\u00bb,<\/strong> <strong>\u0430\u043d\u0433\u043b. \u0441\u043b\u043e\u0432\u043e (m\u0430\u0440 \u2013 \u043a\u0430\u0440\u0442\u0430).<\/strong><\/p>\n<p><em>\u041f\u0440\u0438 \u043f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u044d\u0442\u043e\u0433\u043e \u0437\u0432\u0443\u043a\u0430 \u043a\u043e\u043d\u0447\u0438\u043a \u044f\u0437\u044b\u043a\u0430 \u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u043a \u043d\u0438\u0436\u043d\u0438\u043c \u0437\u0443\u0431\u0430\u043c, \u043f\u0440\u043e\u0438\u0437\u043d\u043e\u0441\u0438\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u0431\u0435\u0437 \u043d\u0430\u043f\u0440\u044f\u0436\u0435\u043d\u0438\u044f.<\/em>\u00a0\u00a0\u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u04d8\u043b\u0438\u044f, \u04d8\u0441\u0438\u044f, \u04d8\u043a\u0435\u043b, \u04d9\u043f\u0435\u0440, \u04d9\u0436\u0435.<\/p>\n<p><strong>\u0406, \u0456 \u2013 \u0433\u043b\u0430\u0441\u043d\u044b\u0439, \u043c\u044f\u0433\u043a\u0438\u0439, \u043d\u0435\u0433\u0443\u0431\u043d\u043e\u0439.<\/strong><\/p>\n<p><em>\u042d\u0442\u043e\u0442 \u0437\u0432\u0443\u043a \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043d\u0435\u043c.\u044f\u0437 \u0456, \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0443\u0442\u0430\u0442\u044c \u0441 \u0440\u0443\u0441\u00ad \u0441\u043a\u0438\u043c \u043b\u0430\u0431\u0438\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u0437\u0432\u0443\u043a\u043e\u043c \u00ab\u0438\u00bb.\u00a0<\/em>\u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u0431\u0456\u0440, \u0435\u043a\u0456, \u043c\u0435\u043d\u0456\u043a\u0456, \u0441\u0435\u043d\u0456\u043a\u0456.<\/p>\n<p><strong>\u04e8, \u04e9 \u2013 \u0433\u043b\u0430\u0441\u043d\u044b\u0439, \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439, \u0433\u0443\u0431\u043d\u043e\u0439. <\/strong><\/p>\n<p>\u0417\u0432\u0443\u0447\u0430\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u043c\u0435\u0436\u0434\u0443 \u0440\u0443\u0441\u0441\u043a\u0438\u043c\u0438 \u0437\u0432\u0443\u043a\u0430\u043c\u0438 \u00ab\u043e, \u0435\u00bb, \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u0435 \u00ab\u00f6\u00bb (b\u00f6r\u0435n). \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u0442\u04e9\u0440\u0442, \u04e9\u0440\u0442, \u04e9\u0442.<\/p>\n<p><strong>\u04ae, \u04af \u2013 \u043c\u044f\u0433\u043a\u0438\u0439, \u0443\u0437\u043a\u0438\u0439, \u0433\u0443\u0431\u043d\u043e\u0439.<\/strong><\/p>\n<p>\u0412 \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 \u00ab\u00dc\u00bb (\u00dc\u0432\u0435r). \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u04af\u0439, \u04af\u0448.<\/p>\n<p><strong> \u04b0, \u04b1 \u2013 \u0442\u0432\u0435\u0440\u0434\u044b\u0439, \u0433\u0443\u0431\u043d\u043e\u0439, \u0443\u0437\u043a\u0438\u0439.<\/strong> \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u04b1\u043d, \u049b\u04b1\u0441.<\/p>\n<p><strong>\u049a, \u049b \u2013 \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u044b\u0439, \u0433\u043b\u0443\u0445\u043e\u0439, \u0432\u0437\u0440\u044b\u0432\u043d\u043e\u0439.<\/strong><\/p>\n<p>\u0412 \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 \u043f\u043e\u0434 \u0443\u0434\u0430\u0440\u0435\u043d\u0438\u0435\u043c \u0441 \u043f\u0440\u0435\u0434\u044b\u0445\u0430\u043d\u0438\u0435\u043c. \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u049b\u0430\u0440\u044b\u043d\u0434\u0430\u0441, \u049b\u0430\u043b\u0430\u043c, \u049b\u04b1\u0441, \u049a\u0430\u043d\u0430\u0442.<\/p>\n<p><strong>\u0492, \u0493 \u2013 \u0442\u0432\u0435\u0440\u0434\u044b\u0439, \u0437\u0432\u043e\u043d\u043a\u0438\u0439, \u0449\u0435\u043b\u0435\u0432\u043e\u0439.<\/strong><\/p>\n<p>\u042d\u0442\u043e\u0442 \u0437\u0432\u0443\u043a \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u0443\u043a\u0440\u0430\u0438\u043d\u0441\u043a\u043e\u043c \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0413\u0440\u0443\u043d\u044f, \u0433\u043e\u0432\u043e\u0440\u0438\u043b\u0430 \u0438 \u0442\u0430\u043a \u0434\u0430\u043b\u0435\u0435. \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u0441\u0430\u0493\u0430\u0442, \u0493\u0438\u043c\u0430\u0440\u0430\u0442.<\/p>\n<p><strong>\u04a2 \u04a3 \u2013 \u0441\u043e\u043d\u043e\u0440\u043d\u044b\u0439. <\/strong><\/p>\n<p>\u0421\u0440\u0430\u0432\u043d\u0438\u0442\u0435: \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u0435 \u00abng\u00bb (s\u0456ngen, 1\u0430ng\u0435\u043f). \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u043c\u0435\u043d\u0456\u04a3, \u0441\u0435\u043d\u0456\u04a3, \u043e\u043d\u044b\u04a3.<\/p>\n<p><strong> \u04bb \u2013 \u0442\u0432\u0435\u0440\u0434\u044b\u0439, \u0433\u043e\u0440\u0442\u0430\u043d\u043d\u044b\u0439.<\/strong><\/p>\n<p>\u0412 \u043d\u0435\u043c\u0435\u0446\u043a\u043e\u043c \u044f\u0437\u044b\u043a\u0435 (\u04bb\u0430\u0438s\u0435). \u041f\u0440\u043e\u0438\u0437\u043d\u0435\u0441\u0438\u0442\u0435: \u0436\u0438\u04bb\u0430\u0437, \u041aa\u04bb\u0430\u0440\u043c\u0430\u043d.<\/p>\n";

class MaterialStoryItemScreen extends Component {
  static navigationOptions = ({navigation, screenProps}) => ({
    title: navigation.state.params.title,
  });

  constructor(props) {
    super(props);
    this.state = {
      data: {},

      progress: true,
      noConnection: false,
    };
  }

  componentDidMount() {
    this.getStoryByIdD();
  }

  getStoryByIdD() {
    const {navigate, goBack} = this.props.navigation;
    this.setState({refreshing: true});
    const {user, id} = this.props.navigation.state.params;
    let formData = new FormData();
    formData.append('user_id', user.id_user);
    formData.append('user_token', user.token);
    formData.append('is_payment', user.is_payment);
    formData.append('task_id', id);
    Api.fetchData(
      Config.DOMAIN + '?action=getStoryByIdD',
      formData,
      this.props.screenProps,
    ).then(result => {
      console.log(result);
      if (result === 'No connection') {
        this.setState({
          noConnection: true,
          refreshing: false,
          progress: false,
        });
      } else {
        if (result.error) {
          Alert.alert('Ошибка!', result.error[0], [
            {
              text: 'OK',
              onPress: () => console.log('OK Pressed'),
              style: 'cancel',
            },
          ]);
          goBack(null);
        } else {
          this.setState({
            data: result,
          });
        }
        this.setState({
          noConnection: false,
          refreshing: false,
          progress: false,
        });
      }
    });
  }

  render() {
    const {navigate, state} = this.props.navigation;
    const {data, progress} = this.state;

    return progress ? (
      <Preloader />
    ) : (
      <View style={styles.main}>
        <ScrollView style={styles.content}>
          <HTML
            source={{html: data.translate}}
            contentWidth={MainStyle._width}
            //containerStyle={{ color: MainStyle.FontColor}}
            tagsStyles={
              {
                //p: { color: MainStyle.FontColor},
                //h1: { color: MainStyle.FontColor, fontSize: 24, fontWeight: 'bold'},
                //h2: { color: MainStyle.FontColor, fontSize: 20, fontWeight: 'bold'},
                //h3: { color: MainStyle.FontColor, fontSize: 18, fontWeight: 'bold'},
              }
            }
          />
          <Text style={styles.title}>Перевод</Text>
          <HTML
            source={{html: data.text}}
            contentWidth={MainStyle._width}
            //containerStyle={{ color: MainStyle.FontColor}}
            tagsStyles={
              {
                //p: { color: MainStyle.FontColor},
                //h1: { color: MainStyle.FontColor, fontSize: 24, fontWeight: 'bold'},
                //h2: { color: MainStyle.FontColor, fontSize: 20, fontWeight: 'bold'},
                //h3: { color: MainStyle.FontColor, fontSize: 18, fontWeight: 'bold'},
              }
            }
          />
          <View style={{height: 100}} />
        </ScrollView>
      </View>
    );
  }
}

const styles = StyleSheet.create({
  main: {
    flex: 1,
    backgroundColor: MainStyle.BGColor,
  },
  title: {
    fontFamily: MainStyle.font,
    fontWeight: 'bold',
    fontSize: 16,
    textAlign: 'center',
    padding: 20,
    color: MainStyle.FontColor,
  },
  content: {
    flex: 1,
    padding: 25,
    paddingHorizontal: 25,
  },
  btnTrain: {
    backgroundColor: '#66BB6A',
    //position: 'absolute',
    marginHorizontal: 25,
    marginBottom: 25,
  },
});

export default MaterialStoryItemScreen;
